var data = require('data');
var parser = require('helper');
function list(response) {
	console.log("Fetch all employees");
	writeToResponse(response, JSON.stringify(data.list()));
}

function deleteEmp(response,postData) {
	var empId = parser.parse(postData)['"empId"'];
	var status = data.deleteEmp(empId);
	console.log("status ");
	writeToResponse(response, status);
}

function edit(response) {
	console.log("Edit employee details");
	writeToResponse(response, "Edit employee details");
}

function add(response) {
	console.log("Add employee");
	writeToResponse(response, "Add employee");
}

function writeToResponse(response, content, statusCode) {
	var headers = {};
	statusCode = (typeof statusCode === "undefined") ? 200 : statusCode;
	 // IE8 does not allow domains to be specified, just the *
	 // headers["Access-Control-Allow-Origin"] = req.headers.origin;
	headers["Access-Control-Allow-Origin"] = "*";
	headers["Access-Control-Allow-Headers"] = "Origin, X-Requested-With, Content-Type, Accept";
	headers["Access-Control-Allow-Methods"] = "POST, GET, PUT, DELETE, OPTIONS";
	headers["Access-Control-Allow-Credentials"] = false;
	headers["Access-Control-Max-Age"] = '86400'; // 24 hours
	response.writeHead(statusCode, headers);
	response.write(content);
	response.end();
}

exports.add = add;
exports.deleteEmp = deleteEmp;
exports.edit = edit;
exports.list = list;