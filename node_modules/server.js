var http = require('http'); //http is a node core module
                            //Modules in node is a pure JS file which contains some useful functions 
                            //or variables. Each module have a diff context(scope).
var url = require('url');//url is a node core module
var queryStr = require('querystring');
function start(router,handle) {
	/*Create server that listens to the port num : 8124 */
	http.createServer(function(request, response){
		console.log('Request received');

		var postData = "";
		var theUrl = url.parse(request.url);
		var pathname = theUrl.pathname;
		request.setEncoding("utf8");
		request.addListener("data", function(postDataChunk) {
			postData += postDataChunk;
			console.log("Received POST data chunk '"+ postDataChunk + "'.");
		});
		request.addListener("end", function() {
			var pData = JSON.parse(JSON.stringify(postData));
			//var queryObj = queryStr.parse(pData);

        // queryObj will contain the data of the query as an object
        // and jsonData will be a property of it
        // so, using JSON.parse will parse the jsonData to create an object
     
			console.log("Received POST data complete'"+ pData['empId']+ "'.");
			router.route(handle, pathname, response, postData);
		});
	}).listen(8000);
	console.log('Server running in port  -- 8124');
} 

exports.start = start;